////////////////////////////////////////////////////////////////////////////////
// INCLUDES
////////////////////////////////////////////////////////////////////////////////
#ifdef __APPLE__
	#include <GLUT/glut.h>
#else
	#include <GL/glut.h>
#endif

#include "game.h"
#include "sprite.h"
#include "opengl.h"

////////////////////////////////////////////////////////////////////////////////
// DEFINES
////////////////////////////////////////////////////////////////////////////////
#define ESCAPE 27

////////////////////////////////////////////////////////////////////////////////
// PRIVATE VARIABLES
////////////////////////////////////////////////////////////////////////////////
static int window;

////////////////////////////////////////////////////////////////////////////////
// PUBLIC FUNCTIONS
////////////////////////////////////////////////////////////////////////////////
void key_press(unsigned char key, int x, int y) 
{
  if (key == ESCAPE) {
    glutDestroyWindow(window);
    game_delete();
    exit(0);
  } else {
    game_key_press(key, x, y);
    glutPostRedisplay();
  }
}
void render() {
  opengl_render();
  game_render();

  glutSwapBuffers();
}

int main(int argc, char **argv) {
  glutInit(&argc, argv);  
  glutInitDisplayMode(GLUT_RGBA | GLUT_DOUBLE | GLUT_ALPHA | GLUT_DEPTH);  
  glutInitWindowSize(640, 480);  
  glutInitWindowPosition(0, 0);  
  window = glutCreateWindow("game");
  glutDisplayFunc(&render);  
  glutKeyboardFunc(&key_press);
  opengl_create(640, 480);
  game_create();
  glutMainLoop();  
  return 0;
}
